# 5. 행동 패턴

## Table of Contents

  1. [책임 연쇄](#책임-연쇄)
  1. [명령](#명령)
  1. [해석자](#해석자)
  1. [반복자](#반복자)
  1. [중재자](#중재자)
  1. [메멘토](#메멘토)
  1. [감시자](#감시자)
  1. [상태](#상태)
  1. [전략](#전략)
  1. [템플릿 메서드](#템플릿-메서드)
  1. [방문자](#방문자)
  1. [참조](#참조)


## 책임 연쇄 



### 구현 

```javascript
var Westeros;
(function (Westeros) {
    (function (JudicialSystem) {
        var Complaint = (function () {
            function Complaint() {
                this.ComplainingParty = "";
                this.ComplaintAbout = "";
                this.Complaint = "";
            }
            return Complaint;
        })();
        JudicialSystem.Complaint = Complaint;

        var ClerkOfTheCourt = (function () {
            function ClerkOfTheCourt() {
            }
            ClerkOfTheCourt.prototype.IsAbleToResolveComplaint = function (complaint) {
                //decide if this is a complaint which can be solved by the clerk
                return false;
            };

            ClerkOfTheCourt.prototype.ListenToComplaint = function (complaint) {
                //perform some operation
                //return solution to the complaint
                return "";
            };
            return ClerkOfTheCourt;
        })();
        JudicialSystem.ClerkOfTheCourt = ClerkOfTheCourt;

        var King = (function () {
            function King() {
            }
            King.prototype.IsAbleToResolveComplaint = function (complaint) {
                return true;
            };

            King.prototype.ListenToComplaint = function (complaint) {
                //perform some operation
                //return solution to the complaint
                return "";
            };
            return King;
        })();
        JudicialSystem.King = King;

        var ComplaintResolver = (function () {
            function ComplaintResolver() {
                this.complaintListeners = new Array();
                this.complaintListeners.push(new ClerkOfTheCourt());
                this.complaintListeners.push(new King());
            }
            ComplaintResolver.prototype.ResolveComplaint = function (complaint) {
                for (var i = 0; i < this.complaintListeners.length; i++) {
                    if (this.complaintListeners[i].IsAbleToResolveComplaint(complaint)) {
                        return this.complaintListeners[i].ListenToComplaint(complaint);
                    }
                }
            };
            return ComplaintResolver;
        })();
        JudicialSystem.ComplaintResolver = ComplaintResolver;
    })(Westeros.JudicialSystem || (Westeros.JudicialSystem = {}));
    var JudicialSystem = Westeros.JudicialSystem;
})(Westeros || (Westeros = {}));
```

**[Back to top](#table-of-contents)**

## 명령 



### 명령 메시지 



### 수신자 



### 호출자 

```javascript
var Westeros;
(function (Westeros) {
    (function (Communication) {
        var BringTroopsCommand = (function () {
            function BringTroopsCommand(location, numberOfTroops, when) {
                this._location = location;
                this._numberOfTroops = numberOfTroops;
                this._when = when;
            }
            BringTroopsCommand.prototype.Execute = function () {
                var receiver = new LordInstructions();
                receiver.BringTroops(this._location, this._numberOfTroops, this._when);
            };
            return BringTroopsCommand;
        })();
        Communication.BringTroopsCommand = BringTroopsCommand;

        var LordInstructions = (function () {
            function LordInstructions() {
            }
            LordInstructions.prototype.BringTroops = function (location, numberOfTroops, when) {
                console.log("You have been instructed to bring " + numberOfTroops + " troops to " + location + " by " + when);
            };
            return LordInstructions;
        })();
        Communication.LordInstructions = LordInstructions;

        var simpleCommand = new Array();
        simpleCommand.push(new LordInstructions().BringTroops);
        simpleCommand.push("King's Landing");
        simpleCommand.push(500);
        simpleCommand.push(new Date());

        simpleCommand[0](simpleCommand[1], simpleCommand[2], simpleCommand[3], simpleCommand[4], simpleCommand[5], simpleCommand[6]);
    })(Westeros.Communication || (Westeros.Communication = {}));
    var Communication = Westeros.Communication;
})(Westeros || (Westeros = {}));
```

**[Back to top](#table-of-contents)**

## 해석자 



### 구현 

```javascript
var Westeros;
(function (Westeros) {
    (function (History) {
        var Battle = (function () {
            function Battle(battleGround, agressor, defender, victor) {
                this.battleGround = battleGround;
                this.agressor = agressor;
                this.defender = defender;
                this.victor = victor;
            }
            return Battle;
        })();
        History.Battle = Battle;

        var Parser = (function () {
            function Parser(battleText) {
                this.battleText = battleText;
                this.currentIndex = 0;
                this.battleList = battleText.split("\n");
            }
            Parser.prototype.nextBattle = function () {
                if (!this.battleList[0])
                    return null;
                var segments = this.battleList[0].match(/\((.+?)\s?->\s?(.+?)\s?<-\s?(.+?)\s?->\s?(.+)/);
                return new Battle(segments[2], segments[1], segments[3], segments[4]);
            };
            return Parser;
        })();
        History.Parser = Parser;
    })(Westeros.History || (Westeros.History = {}));
    var History = Westeros.History;
})(Westeros || (Westeros = {}));
```

**[Back to top](#table-of-contents)**

### 예제 



## 반복자 



### ECMAScript 6 반복자 



### 구현 

```javascript
var Westeros;
(function (Westeros) {
    (function (Succession) {
        var KingSuccession = (function () {
            function KingSuccession(inLineForThrone) {
                this.inLineForThrone = inLineForThrone;
                this.pointer = 0;
            }
            KingSuccession.prototype.next = function () {
                return this.inLineForThrone[this.pointer++];
            };
            return KingSuccession;
        })();
        Succession.KingSuccession = KingSuccession;

        var FibonacciIterator = (function () {
            function FibonacciIterator() {
                this.previous = 1;
                this.beforePrevious = 1;
            }
            FibonacciIterator.prototype.next = function () {
                var current = this.previous + this.beforePrevious;
                this.beforePrevious = this.previous;
                this.previous = current;
                return current;
            };
            return FibonacciIterator;
        })();
        Succession.FibonacciIterator = FibonacciIterator;
    })(Westeros.Succession || (Westeros.Succession = {}));
    var Succession = Westeros.Succession;
})(Westeros || (Westeros = {}));
```

**[Back to top](#table-of-contents)**

## 중재자 

mediator

### 설명 from wikipedia

> What problems can the Mediator design pattern solve?
>  
> * **Tight coupling** between a set of interacting objects should be avoided.
>  
> * It should be possible to change the interaction between a set of objects **independently**.

> What solution does the Mediator design pattern describe?
>  
> * Define a separate (mediator) object that **encapsulates the interaction between a set of objects**.
>  
> * Objects **delegate** their interaction to a mediator object instead of interacting with each other directly.

### 특징(작성자가 파악한 것이라 정확하지 않을 수 있음.)

* class
  * mediator
    * 통신을 대리해주는 객체.
  * colleague
    * 통신하려고 하는 객체들.
    * mediator 의 참조값을 가짐.
    * 같은 레벨(같은 인터페이스 상속)로 이루어 짐.
* observer 패턴과 유사성
  * subject 가 observer 를 등록하느 것이 비슷해 보임.


### 구현 

ex. from book

```javascript
var Westeros;
(function (Westeros) {
    (function (Alliances) {
        // mediator
        var HouseStark = (function () {
            function HouseStark() {
                this.karstark = new Karstark(this);
                this.bolton = new Bolton(this);
                this.frey = new Frey(this);
                this.umber = new Umber(this);
            }
            // used in colleague
            HouseStark.prototype.routeMessage = function (message) {
            };
            return HouseStark;
        })();
        Alliances.HouseStark = HouseStark;

        // colleague1
        var Karstark = (function () {
            function Karstark(greatLord) {
                this.greatLord = greatLord;
            }
            Karstark.prototype.receiveMessage = function (message) {
            };
            Karstark.prototype.sendMessage = function (message) {
                this.greatLord.routeMessage(message);
            };
            return Karstark;
        })();
        Alliances.Karstark = Karstark;

        // colleague2
        var Bolton = (function () {
            function Bolton(greatLord) {
                this.greatLord = greatLord;
            }
            Bolton.prototype.receiveMessage = function (message) {
            };
            Bolton.prototype.sendMessage = function (message) {
                this.greatLord.routeMessage(message);
            };
            return Bolton;
        })();
        Alliances.Bolton = Bolton;

        // colleague3
        var Frey = (function () {
            function Frey(greatLord) {
                this.greatLord = greatLord;
            }
            Frey.prototype.receiveMessage = function (message) {
            };
            Frey.prototype.sendMessage = function (message) {
                this.greatLord.routeMessage(message);
            };
            return Frey;
        })();
        Alliances.Frey = Frey;

        // colleague4
        var Umber = (function () {
            function Umber(greatLord) {
                this.greatLord = greatLord;
            }
            Umber.prototype.receiveMessage = function (message) {
            };
            Umber.prototype.sendMessage = function (message) {
                this.greatLord.routeMessage(message);
            };
            return Umber;
        })();
        Alliances.Umber = Umber;
    })(Westeros.Alliances || (Westeros.Alliances = {}));
    var Alliances = Westeros.Alliances;
})(Westeros || (Westeros = {}));
```

ex. chat(from [http://www.dofactory.com/javascript/mediator-design-pattern](http://www.dofactory.com/javascript/mediator-design-pattern))

```javascript
// colleague
var Participant = function(name) {
    this.name = name;
    this.chatroom = null;
};
 
Participant.prototype = {
    send: function(message, to) {
        this.chatroom.send(message, this, to);
    },
    receive: function(message, from) {
        log.add(from.name + " to " + this.name + ": " + message);
    }
};
```

```javascript 
// mediator
var Chatroom = function() {
    var participants = {};
 
    return {
 
        register: function(participant) {
            participants[participant.name] = participant;
            participant.chatroom = this;
        },
 
        send: function(message, from, to) {
            if (to) {                      // single message
                to.receive(message, from);    
            } else {                       // broadcast message
                for (key in participants) {   
                    if (participants[key] !== from) {
                        participants[key].receive(message, from);
                    }
                }
            }
        }
    };
};
```

```javascript
// log helper
var log = (function() {
    var log = "";
 
    return {
        add: function(msg) { log += msg + "\n"; },
        show: function() { alert(log); log = ""; }
    }
})();

function run() {
    var yoko = new Participant("Yoko");
    var john = new Participant("John");
    var paul = new Participant("Paul");
    var ringo = new Participant("Ringo");
 
    var chatroom = new Chatroom();
    chatroom.register(yoko);
    chatroom.register(john);
    chatroom.register(paul);
    chatroom.register(ringo);
 
    yoko.send("All you need is love.");
    yoko.send("I love you John.");
    john.send("Hey, no need to broadcast", yoko);
    paul.send("Ha, I heard that!");
    ringo.send("Paul, what do you think?", paul);
 
    log.show();
}
```

ref.

* [http://www.dofactory.com/javascript/mediator-design-pattern](http://www.dofactory.com/javascript/mediator-design-pattern)
* [http://loredanacirstea.github.io/es6-design-patterns/#mediator](http://loredanacirstea.github.io/es6-design-patterns/#mediator)
* [https://en.wikipedia.org/wiki/Mediator_pattern](https://en.wikipedia.org/wiki/Mediator_pattern)
* other study ref.
  * [BHKIM.md#중재자-mediator](https://github.com/js-jsm/pattern2018/blob/master/05_%ED%96%89%EB%8F%99_%ED%8C%A8%ED%84%B4/BHKIM.md#중재자-mediator)
  * [DOHYUNG.md#mediator](https://github.com/js-jsm/pattern2018/blob/master/05_%ED%96%89%EB%8F%99_%ED%8C%A8%ED%84%B4/DOHYUNG.md#mediator)
  * [JINHO.md#중재자-mediator-1](https://github.com/js-jsm/pattern2018/blob/master/05_%ED%96%89%EB%8F%99_%ED%8C%A8%ED%84%B4/JINHO.md#중재자-mediator-1)
  * [Jieun.md#mediator-pattern중재자-패턴](https://github.com/js-jsm/pattern2018/blob/master/05_%ED%96%89%EB%8F%99_%ED%8C%A8%ED%84%B4/Jieun.md#mediator-pattern중재자-패턴)
  * [jaenam.md#5-mediator](https://github.com/js-jsm/pattern2018/blob/master/05_%ED%96%89%EB%8F%99_%ED%8C%A8%ED%84%B4/jaenam.md#5-mediator)
  * [jina.md#2-mediator-pattern--중재자-패턴](https://github.com/js-jsm/pattern2018/blob/master/05_%ED%96%89%EB%8F%99_%ED%8C%A8%ED%84%B4/jina.md#2-mediator-pattern--중재자-패턴)
  * [junghyun.md#mediator-pattern](https://github.com/js-jsm/pattern2018/blob/master/05_%ED%96%89%EB%8F%99_%ED%8C%A8%ED%84%B4/junghyun.md#mediator-pattern)

**[Back to top](#table-of-contents)**

## 메멘토 

memento

### 설명 from wikipedia

What problems can the Memento design pattern solve?

```
The internal state of an object should be saved externally so that the object can be restored to this state later.
The object's encapsulation must not be violated.
```

What solution does the Memento design pattern describe?
```
Make an object (originator) itself responsible for

saving its internal state to a (memento) object and
restoring to a previous state from a (memento) object.
```

### 특징((작성자가 파악한 것이라 정확하지 않을 수 있음.)

* class
  * originator
    * memento 보관
  * memento
    * VO(Value Object)로 사용되는 객체
  * caretaker
    * memento 를 저장, 복구 요청 하는 객체
* undo(rollback) 구현의 해결법으로 많이 사용됨.

### 구현 

ex. from book

```javascript
var Westeros;
(function (Westeros) {
    (function (Foretelling) {
        // 
        var SquareCommand = (function () {
            function SquareCommand(numberToSquare) {
                this.numberToSquare = numberToSquare;
            }
            SquareCommand.prototype.Execute = function () {
                this.numberToSquare *= this.numberToSquare;
            };
            return SquareCommand;
        })();
        Foretelling.SquareCommand = SquareCommand;

        // memento
        var WorldState = (function () {
            function WorldState(numberOfKings, currentKingInKingsLanding, season) {
                this.numberOfKings = numberOfKings;
                this.currentKingInKingsLanding = currentKingInKingsLanding;
                this.season = season;
            }
            return WorldState;
        })();
        Foretelling.WorldState = WorldState;

        // caretaker
        var Soothsayer = (function () {
            function Soothsayer() {
                this.startingPoints = [];
                this.currentState = new WorldStateProvider();
            }
            Soothsayer.prototype.setInitialConditions = function (numberOfKings, currentKingInKingsLanding, season) {
                this.currentState.numberOfKings = numberOfKings;
                this.currentState.currentKingInKingsLanding = currentKingInKingsLanding;
                this.currentState.season = season;
            };
            Soothsayer.prototype.alterNumberOfKingsAndForetell = function (numberOfKings) {
                this.startingPoints.push(this.currentState.saveMemento());
                this.currentState.numberOfKings = numberOfKings;
            };
            Soothsayer.prototype.alterSeasonAndForetell = function (season) {
                this.startingPoints.push(this.currentState.saveMemento());
                this.currentState.season = season;
            };
            Soothsayer.prototype.alterCurrentKingInKingsLandingAndForetell = function (currentKingInKingsLanding) {
                this.startingPoints.push(this.currentState.saveMemento());
                this.currentState.currentKingInKingsLanding = currentKingInKingsLanding;
            };
            Soothsayer.prototype.tryADifferentChange = function () {
                this.currentState.restoreMemento(this.startingPoints.pop());
            };
            return Soothsayer;
        })();
        Foretelling.Soothsayer = Soothsayer;

        // originator
        var WorldStateProvider = (function () {
            function WorldStateProvider() {
            }
            WorldStateProvider.prototype.saveMemento = function () {
                return new WorldState(this.numberOfKings, this.currentKingInKingsLanding, this.season);
            };
            WorldStateProvider.prototype.restoreMemento = function (memento) {
                this.numberOfKings = memento.numberOfKings;
                this.currentKingInKingsLanding = memento.currentKingInKingsLanding;
                this.season = memento.season;
            };
            return WorldStateProvider;
        })();
        Foretelling.WorldStateProvider = WorldStateProvider;
    })(Westeros.Foretelling || (Westeros.Foretelling = {}));
    var Foretelling = Westeros.Foretelling;
})(Westeros || (Westeros = {}));
```

ex. restore original state(from [http://www.dofactory.com/javascript/memento-design-pattern](http://www.dofactory.com/javascript/memento-design-pattern))

```javascript
// memento
var Person = function(name, street, city, state) {
    this.name = name;
    this.street = street;
    this.city = city;
    this.state = state;
}
 
Person.prototype = {
 
    hydrate: function() {
        var memento = JSON.stringify(this);
        return memento;
    },
 
    dehydrate: function(memento) {
        var m = JSON.parse(memento);
        this.name = m.name;
        this.street = m.street;
        this.city = m.city;
        this.state = m.state;
    }
}
```

```javascript 
// caretaker
var CareTaker = function() {
    this.mementos = {};
 
    this.add = function(key, memento) {
        this.mementos[key] = memento;
    },
 
    this.get = function(key) {
        return this.mementos[key];
    }
}
```

```javascript
// log helper
var log = (function () {
    var log = "";
 
    return {
        add: function (msg) { log += msg + "\n"; },
        show: function () { alert(log); log = ""; }
    }
})();
 
 
function run() {
    var mike = new Person("Mike Foley", "1112 Main", "Dallas", "TX");
    var john = new Person("John Wang", "48th Street", "San Jose", "CA");
    var caretaker = new CareTaker();
 
    // save state
 
    caretaker.add(1, mike.hydrate());
    caretaker.add(2, john.hydrate());
 
    // mess up their names
 
    mike.name = "King Kong";
    john.name = "Superman";
 
    // restore original state
 
    mike.dehydrate(caretaker.get(1));
    john.dehydrate(caretaker.get(2));
 
    log.add(mike.name);
    log.add(john.name);
 
    log.show();
}
```

ref.

* [http://www.dofactory.com/javascript/memento-design-pattern](http://www.dofactory.com/javascript/memento-design-pattern)
* [http://loredanacirstea.github.io/es6-design-patterns/#memento](http://loredanacirstea.github.io/es6-design-patterns/#memento)
* [https://en.wikipedia.org/wiki/Memento_pattern](https://en.wikipedia.org/wiki/Memento_pattern)
* other study ref.
  * [BHKIM.md#메멘토-memento](https://github.com/js-jsm/pattern2018/blob/master/05_%ED%96%89%EB%8F%99_%ED%8C%A8%ED%84%B4/BHKIM.md#메멘토-memento)
  * [DOHYUNG.md#memento](https://github.com/js-jsm/pattern2018/blob/master/05_%ED%96%89%EB%8F%99_%ED%8C%A8%ED%84%B4/DOHYUNG.md#memento)
  * [JINHO.md#메멘토-memento-1](https://github.com/js-jsm/pattern2018/blob/master/05_%ED%96%89%EB%8F%99_%ED%8C%A8%ED%84%B4/JINHO.md#메멘토-memento-1)
  * [Jieun.md#메멘토-패턴](https://github.com/js-jsm/pattern2018/blob/master/05_%ED%96%89%EB%8F%99_%ED%8C%A8%ED%84%B4/Jieun.md#메멘토-패턴)
  * [jaenam.md#6-memento](https://github.com/js-jsm/pattern2018/blob/master/05_%ED%96%89%EB%8F%99_%ED%8C%A8%ED%84%B4/jaenam.md#6-memento)
  * [junghyun.md#memento-pattern](https://github.com/js-jsm/pattern2018/blob/master/05_%ED%96%89%EB%8F%99_%ED%8C%A8%ED%84%B4/junghyun.md#memento-pattern)

**[Back to top](#table-of-contents)**

## 감시자

Observer

* subject(publish)
* observer(subscribe)

ref.

* (https://en.wikipedia.org/wiki/Observer_pattern)
* (http://www.dofactory.com/javascript/observer-design-pattern)
* (http://loredanacirstea.github.io/es6-design-patterns/#observer)

### 구현

```javascript
var Westeros;
(function (Westeros) {
    (function (Court) {
        // ?
        var GetterSetter = (function () {
            function GetterSetter() {
            }
            GetterSetter.prototype.GetProperty = function () {
                return this._property;
            };
            GetterSetter.prototype.SetProperty = function (value) {
                var temp = this._property;
                this._property = value;
                this._listener.Event(value, temp);
            };
            return GetterSetter;
        })();

        // ?
        var Listener = (function () {
            function Listener() {
            }
            Listener.prototype.Event = function (newValue, oldValue) {
                //do something
            };
            return Listener;
        })();

        // subject(publisher)
        var Spy = (function () {
            function Spy() {
                this._partiesToNotify = []; // observers(subscriber)
            }
            Spy.prototype.Subscribe = function (subscriber) {
                this._partiesToNotify.push(subscriber);
            };

            Spy.prototype.Unsubscribe = function (subscriber) {
                this._partiesToNotify.remove(subscriber);
            };

            Spy.prototype.SetPainKillers = function (painKillers) {
                this._painKillers = painKillers;
                for (var i = 0; i < this._partiesToNotify.length; i++) {
                    this._partiesToNotify[i](painKillers);
                }
            };
            return Spy;
        })();

        // ?
        var Player = (function () {
            function Player() {
            }
            Player.prototype.OnKingPainKillerChange = function (newPainKillerAmount) {
                //perform some action
            };
            return Player;
        })();
    })(Westeros.Court || (Westeros.Court = {}));
    var Court = Westeros.Court;
})(Westeros || (Westeros = {}));
```

**[Back to top](#table-of-contents)**

## 상태

State

* context
* state

ref.

* (https://en.wikipedia.org/wiki/State_pattern)
* (http://www.dofactory.com/javascript/state-design-pattern)
* (http://loredanacirstea.github.io/es6-design-patterns/#state)

### 구현

```javascript
var Westeros;
(function (Westeros) {
    (function (Banking) {
        // ?
        var NaiveBanking = (function () {
            function NaiveBanking() {
                this.state = "";
                this.balance = 0;
            }
            NaiveBanking.prototype.NextState = function (action, amount) {
                if (this.state == "overdrawn" && action == "withdraw") {
                    this.state = "on hold";
                }
                if (this.state == "on hold" && action != "deposit") {
                    this.state = "on hold";
                }
                if (this.state == "good standing" && action == "withdraw" && amount <= this.balance) {
                    this.balance -= amount;
                }
                if (this.state == "good standing" && action == "withdraw" && amount > this.balance) {
                    this.balance -= amount;
                    this.state = "overdrawn";
                }
            };
            return NaiveBanking;
        })();

        // context
        var BankAccountManager = (function () {
            function BankAccountManager() {
                this.currentState = new GoodStandingState(this);
            }
            BankAccountManager.prototype.Deposit = function (amount) {
                this.currentState.Deposit(amount);
            };

            BankAccountManager.prototype.Withdraw = function (amount) {
                this.currentState.Withdraw(amount);
            };
            BankAccountManager.prototype.addToBalance = function (amount) {
                this.balance += amount;
            };
            BankAccountManager.prototype.getBalance = function () {
                return this.balance;
            };
            BankAccountManager.prototype.moveToState = function (newState) {
                this.currentState = newState;
            };
            return BankAccountManager;
        })();
        Banking.BankAccountManager = BankAccountManager;

        // state 1
        var GoodStandingState = (function () {
            function GoodStandingState(manager) {
                this.manager = manager;
            }
            GoodStandingState.prototype.Deposit = function (amount) {
                this.manager.addToBalance(amount);
            };
            GoodStandingState.prototype.Withdraw = function (amount) {
                if (this.manager.getBalance() < amount) {
                    this.manager.moveToState(new OverdrawnState(this.manager));
                }

                this.manager.addToBalance(-1 * amount);
            };
            return GoodStandingState;
        })();
        Banking.GoodStandingState = GoodStandingState;

        // state 2
        var OverdrawnState = (function () {
            function OverdrawnState(manager) {
                this.manager = manager;
            }
            OverdrawnState.prototype.Deposit = function (amount) {
                this.manager.addToBalance(amount);
                if (this.manager.getBalance() > 0) {
                    this.manager.moveToState(new GoodStandingState(this.manager));
                }
            };
            OverdrawnState.prototype.Withdraw = function (amount) {
                this.manager.moveToState(new OnHold(this.manager));
                throw "Cannot withdraw money from an already overdrawn bank account";
            };
            return OverdrawnState;
        })();
        Banking.OverdrawnState = OverdrawnState;

        // state 3
        var OnHold = (function () {
            function OnHold(manager) {
                this.manager = manager;
            }
            OnHold.prototype.Deposit = function (amount) {
                this.manager.addToBalance(amount);
                throw "Your account is on hold and you must attend the bank to resolve the issue";
            };
            OnHold.prototype.Withdraw = function (amount) {
                throw "Your account is on hold and you must attend the bank to resolve the issue";
            };
            return OnHold;
        })();
        Banking.OnHold = OnHold;
    })(Westeros.Banking || (Westeros.Banking = {}));
    var Banking = Westeros.Banking;
})(Westeros || (Westeros = {}));
```

**[Back to top](#table-of-contents)**

## 전 략

Strategy

* context
* strategy

ref.

* (https://en.wikipedia.org/wiki/Strategy_pattern)
* (http://www.dofactory.com/javascript/strategy-design-pattern)
* (http://loredanacirstea.github.io/es6-design-patterns/#strategy)

### 구현

```javascript
var Westeros;
(function (Westeros) {
    (function (Travel) {
        // ?
        var TravelResult = (function () {
            function TravelResult(durationInDays, probabilityOfDeath, cost) {
                this.durationInDays = durationInDays;
                this.probabilityOfDeath = probabilityOfDeath;
                this.cost = cost;
            }
            return TravelResult;
        })();
        Travel.TravelResult = TravelResult;

        // strategy 1
        var SeaGoingVessel = (function () {
            function SeaGoingVessel() {
            }
            SeaGoingVessel.prototype.Travel = function (source, destination) {
                return new TravelResult(15, .25, 500);
            };
            return SeaGoingVessel;
        })();
        Travel.SeaGoingVessel = SeaGoingVessel;

        // strategy 2
        var Horse = (function () {
            function Horse() {
            }
            Horse.prototype.Travel = function (source, destination) {
                return new TravelResult(30, .25, 50);
            };
            return Horse;
        })();
        Travel.Horse = Horse;

        // strategy 3
        var Walk = (function () {
            function Walk() {
            }
            Walk.prototype.Travel = function (source, destination) {
                return new TravelResult(150, .55, 0);
            };
            return Walk;
        })();
        Travel.Walk = Walk;
    })(Westeros.Travel || (Westeros.Travel = {}));
    var Travel = Westeros.Travel;
})(Westeros || (Westeros = {}));
```

```javascript
var currentMoney = 70;
var strat;
// context
if (currentMoney > 500)
    strat = new Westeros.Travel.SeaGoingVessel();
else if (currentMoney > 50)
    strat = new Westeros.Travel.Horse();
else
    strat = new Westeros.Travel.Walk();
```

**[Back to top](#table-of-contents)**

## 템플릿 메서드

Template Method

Keyword

* IOC
* Inheritance (computer science)
* **Method overriding** (programming)
* other patterns
  * Adapter
  * Strategy

ref.

* (https://en.wikipedia.org/wiki/Template_method_pattern)
* [Six common uses of the Template Design Pattern_ Design Pattern series - CodeProject](https://www.codeproject.com/Articles/307452/common-use-of-Template-Design-pattern-Design-pat)
    * example
      * Flexible extendable generalized specialized user interfaces
      * ASP.NET page **life cycle**
        * hook
      * Code generators
      * XML parser
      * Validation in business components
      * Customizable logging utility
* (http://www.dofactory.com/javascript/template-method-design-pattern)
* (http://loredanacirstea.github.io/es6-design-patterns/#template-method)
* other study ref.
  * (https://github.com/js-jsm/pattern2018/blob/master/05_%ED%96%89%EB%8F%99_%ED%8C%A8%ED%84%B4/DOHYUNG.md#template-method)
  * (https://github.com/js-jsm/pattern2018/blob/master/05_%ED%96%89%EB%8F%99_%ED%8C%A8%ED%84%B4/JINHO.md#템플릿-메소드-template-method-1)
  * (https://github.com/js-jsm/pattern2018/blob/master/05_%ED%96%89%EB%8F%99_%ED%8C%A8%ED%84%B4/junghyun.md#template-pattern)
* article
  * [Where should we use Template Method - pattern_ - Stack Overflow](https://stackoverflow.com/questions/1553856/where-should-we-use-template-method-pattern/23619308?utm_medium=organic&utm_source=google_rich_qa&utm_campaign=google_rich_qa)
    * example
      * java.util.AbstractList
      * **Servlet's doGet and doPost methods**
      * MDB's onMessage method
      * Struts Action class
      * **Spring's data access classes**
  * [What is the difference between the template method and the strategy patterns_ - Stack Overflow](https://stackoverflow.com/questions/669271/what-is-the-difference-between-the-template-method-and-the-strategy-patterns)
    * compile-time vs runtime
        * Template method pattern: compile-time algorithm selection by subclassing
        * Strategy pattern: run-time algorithm selection by containment

### 구현

```javascript
var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
```

```javascript
var Westeros;
(function (Westeros) {
    (function (Food) {
        // AbstractClass
        var BasicBeer = (function () {
            function BasicBeer() {
            }
            BasicBeer.prototype.Create = function () {
                this.AddIngredients();
                this.Stir();
                this.Ferment();
                this.Test();
                if (this.TestingPassed()) {
                    this.Distribute();
                }
            };

            BasicBeer.prototype.AddIngredients = function () {
                throw "Add ingredients needs to be implemented";
            };

            BasicBeer.prototype.Stir = function () {
                //stir 15 times with a wooden spoon
            };

            BasicBeer.prototype.Ferment = function () {
                //let stand for 30 days
            };

            BasicBeer.prototype.Test = function () {
                //draw off a cup of beer and taste it
            };

            BasicBeer.prototype.TestingPassed = function () {
                throw "Conditions to pass a test must be implemented";
            };

            BasicBeer.prototype.Distribute = function () {
                //place beer in 50L casks
            };
            return BasicBeer;
        })();
        Food.BasicBeer = BasicBeer;

        // Concrete Class
        var RaspberryBeer = (function (_super) {
            __extends(RaspberryBeer, _super);
            function RaspberryBeer() {
                _super.apply(this, arguments);
            }
            // Method overriding 1
            RaspberryBeer.prototype.AddIngredients = function () {
                //add ingredients, probably including raspberries
            };

            // Method overriding 2
            RaspberryBeer.prototype.TestingPassed = function () {
                //beer must be reddish and taste of raspberries
            };
            return RaspberryBeer;
        })(BasicBeer);
        Food.RaspberryBeer = RaspberryBeer;
    })(Westeros.Food || (Westeros.Food = {}));
    var Food = Westeros.Food;
})(Westeros || (Westeros = {}));
```

**[Back to top](#table-of-contents)**

## 방문자

Visitor

* client
* element
  * visitor.visit(self); 구문 존재
* visitor
  * element.visit(visitor); 구문 존재

ref.

* (https://en.wikipedia.org/wiki/Visitor_pattern)
* (http://www.dofactory.com/javascript/visitor-design-pattern)
* (http://loredanacirstea.github.io/es6-design-patterns/#visitor)

```javascript
var Westeros;
(function (Westeros) {
    (function (Army) {
        // element 1
        var Knight = (function () {
            function Knight() {
                this._type = "Westeros.Army.Knight";
            }
            Knight.prototype.printName = function () {
                console.log("Knight");
            };
            Knight.prototype.visit = function (visitor) {
                visitor.visit(this);
            };
            return Knight;
        })();
        Army.Knight = Knight;

        // element 2
        var FootSoldier = (function () {
            function FootSoldier() {
                this._type = "Westeros.Army.FootSoldier";
            }
            FootSoldier.prototype.printName = function () {
                console.log("FootSoldier");
            };
            FootSoldier.prototype.visit = function (visitor) {
                visitor.visit(this);
            };
            return FootSoldier;
        })();
        Army.FootSoldier = FootSoldier;

        // element 3
        var Archer = (function () {
            function Archer() {
                this._type = "Westeros.Army.Archer";
            }
            Archer.prototype.printName = function () {
                console.log("Archer");
            };
            Archer.prototype.visit = function (visitor) {
                visitor.visit(this);
            };
            return Archer;
        })();
        Army.Archer = Archer;
        
        // element 4
        var Lord = (function () {
            function Lord() {
                this._type = "Westeros.Army.Lord";
            }
            Lord.prototype.printName = function () {
                console.log("Lord");
            };
            Lord.prototype.visit = function (visitor) {
                visitor.visit(this);
            };
            return Lord;
        })();
        Army.Lord = Lord;

        // client 1
        var InstanceOfExample = (function () {
            function InstanceOfExample() {
            }
            InstanceOfExample.prototype.Execute = function () {
                var collection = [];
                collection.push(Object.create(Knight));
                collection.push(Object.create(FootSoldier));
                collection.push(new Lord());
                collection.push(new Archer());

                for (var i = 0; i < collection.length; i++) {
                    if (collection[i] instanceof Westeros.Army.Knight)
                        collection[i].printName();
                    else
                        console.log("No match");
                }
            };
            return InstanceOfExample;
        })();
        Army.InstanceOfExample = InstanceOfExample;

        // client 2
        var IfExample = (function () {
            function IfExample() {
            }
            IfExample.prototype.Execute = function () {
                var collection = [];
                collection.push(new Knight());
                collection.push(new FootSoldier());
                collection.push(new Lord());
                collection.push(new Archer());

                for (var i = 0; i < collection.length; i++) {
                    if (collection[i]._type == 'Westeros.Army.Knight')
                        collection[i].printName();
                    else
                        console.log("No match");
                }
            };
            return IfExample;
        })();
        Army.IfExample = IfExample;

        // client 3
        var VisitorExample = (function () {
            function VisitorExample() {
            }
            VisitorExample.prototype.Execute = function () {
                var collection = [];
                collection.push(new Knight());
                collection.push(new FootSoldier());
                collection.push(new Lord());
                collection.push(new Archer());
                var visitor = new SelectiveNamePrinterVisitor();
                for (var i = 0; i < collection.length; i++) {
                    collection[i].visit(visitor);
                }
            };
            return VisitorExample;
        })();
        Army.VisitorExample = VisitorExample;

        // visitor
        var SelectiveNamePrinterVisitor = (function () {
            function SelectiveNamePrinterVisitor() {
            }
            // implements a visit method
            SelectiveNamePrinterVisitor.prototype.visit = function (memberOfArmy) {
                if (memberOfArmy instanceof Westeros.Army.Knight) {
                    this.VisitKnight(memberOfArmy);
                } else {
                    console.log("Not a knight");
                }
            };

            SelectiveNamePrinterVisitor.prototype.VisitKnight = function (memberOfArmy) {
                memberOfArmy.printName();
            };
            return SelectiveNamePrinterVisitor;
        })();
    })(Westeros.Army || (Westeros.Army = {}));
    var Army = Westeros.Army;
})(Westeros || (Westeros = {}));
```

```javascript
console.log("Instance of");
var a = new Westeros.Army.InstanceOfExample();
a.Execute();
console.log("Type of");
var b = new Westeros.Army.IfExample();
b.Execute();
console.log("Internal type");
var c = new Westeros.Army.VisitorExample();
c.Execute();
```

**[Back to top](#table-of-contents)**

## 힌트와 팁

**[Back to top](#table-of-contents)**

## 요약

**[Back to top](#table-of-contents)**

## 참조

* [pattern2018/05_행동_패턴/](https://github.com/js-jsm/pattern2018/tree/master/05_%ED%96%89%EB%8F%99_%ED%8C%A8%ED%84%B4)
* [http://loredanacirstea.github.io/es6-design-patterns/](http://loredanacirstea.github.io/es6-design-patterns/#behavioral-patterns)
* [http://www.dofactory.com/javascript/design-patterns](http://www.dofactory.com/javascript/design-patterns)
